# 拼多多自动购买脚本 - 模块化版本

## 项目结构

```
pdd-script/
├── main.js                    # 主入口文件
├── config/                    # 配置文件目录
│   └── app-config.js         # 应用配置
├── utils/                     # 工具模块目录
│   ├── common.js             # 通用工具函数
│   ├── logger.js             # 日志管理
│   └── permissions.js        # 权限管理
├── ui/                        # UI模块目录
│   └── floating-window.js    # 悬浮窗UI
├── modules/                   # 功能模块目录
│   └── pdd/                  # 拼多多相关模块
│       ├── pdd-module.js     # 拼多多主模块
│       ├── app-launcher.js   # 应用启动器
│       ├── product-finder.js # 商品查找器
│       ├── purchase-handler.js # 购买处理器
│       └── collect-handler.js # 收集处理器
└── README.md                  # 项目说明
```

## 模块说明

### 主入口 (main.js)
- 协调各个模块的工作
- 初始化应用和权限检查
- 管理应用生命周期

### 配置模块 (config/)
- **app-config.js**: 存储应用的所有配置信息，包括拼多多包名、按钮文本、等待时间等

### 工具模块 (utils/)
- **common.js**: 提供通用工具函数，如价格解析、安全点击、元素查找等
- **logger.js**: 统一的日志管理，支持不同级别的日志记录
- **permissions.js**: 权限检查和请求，包括无障碍服务和悬浮窗权限

### UI模块 (ui/)
- **floating-window.js**: 悬浮窗UI的创建和管理，包括事件处理和回调设置

### 功能模块 (modules/)
- **product-purchase.js**: 商品购买功能的主模块，处理自动购买流程
- **user-info.js**: 用户信息获取和管理模块

## 使用方法

1. 确保已安装拼多多应用
2. 运行 `main.js` 启动脚本
3. 授予必要的权限（无障碍服务、悬浮窗权限）
4. 在悬浮窗中设置目标价格
5. 点击启动开关开始自动购买

## 扩展功能

由于采用了模块化设计，可以轻松添加新功能：

### 添加新的购物平台
1. 在 `modules/` 下创建新的平台目录
2. 实现对应的启动器、商品查找器、购买处理器等
3. 在主模块中集成新平台

### 添加新的UI功能
1. 在 `ui/` 目录下创建新的UI组件
2. 在主入口中引入和初始化

### 添加新的工具函数
1. 在 `utils/` 目录下添加新的工具模块
2. 在需要的地方引入使用

## 配置说明

所有配置都集中在 `config/app-config.js` 中，包括：
- 应用包名
- 按钮文本
- 等待时间
- 价格匹配规则
- 界面元素标识

## 注意事项

1. 本脚本仅用于学习和研究目的
2. 使用前请确保了解相关法律法规
3. 建议在测试环境中使用
4. 请勿用于商业用途

## 开发指南

### 添加新功能模块
1. 在对应目录下创建新的 `.js` 文件
2. 使用 `module.exports` 导出功能
3. 在需要的地方使用 `require()` 引入
4. 遵循现有的代码结构和命名规范

### 调试和日志
- 使用 `logger` 模块记录日志
- 支持不同级别的日志：info、error、warn、debug
- 悬浮窗会显示实时日志信息

### 错误处理
- 所有模块都包含适当的错误处理
- 使用 try-catch 包装可能出错的操作
- 错误信息会记录到日志中
